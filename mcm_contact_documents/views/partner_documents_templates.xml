<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="portal_layout" name="Portal layout: document menu entry" inherit_id="portal.portal_breadcrumbs"
              priority="50">
        <xpath expr="//ol[hasclass('o_portal_submenu')]" position="inside">
            <li t-if="page_name == 'document' or document"
                t-attf-class="breadcrumb-item #{'active ' if not document else ''}">
                <a t-if="document" t-attf-href="/my/documents?{{ keep_query() }}">Document</a>
                <t t-else="">Document</t>
            </li>
            <li t-if="document" class="breadcrumb-item active">
                <t t-esc="document.name"/>
            </li>
        </xpath>
    </template>
    <template id="portal_my_home" name="Portal My Home : document entries" inherit_id="portal.portal_my_home"
              priority="40">
        <xpath expr="//div[hasclass('o_portal_docs')]" position="inside">
            <t t-if="document_count" t-call="portal.portal_docs_entry">
                <t t-set="title">Documents</t>
                <t t-set="url" t-value="'/my/documents'"/>
                <t t-set="count" t-value="document_count"/>
            </t>
        </xpath>
        <xpath expr="//div[@class='o_portal_docs list-group']" position="after">
            <style>
                @media (max-width: 767px) {
                .renonce{
                padding-bottom: 14px;
                }
                }

            </style>
            <div class="input checkbox renonce" id="request_renonce">
                <h5 class="list-group-item" t-if="user_id.partner_id.renounce_request==True">
                    <span class="d-flex align-items-center justify-content-between">
                        Renonciation au droit de rétractation conformément aux dispositions de l'article L.221-28 1°
                        <i class="fa fa-check-circle text-success" role="img" aria-label="Success" title="Success"/>
                    </span>
                </h5>
                <div class="renonce" style="padding-top:24px;" t-if="user_id.partner_id.renounce_request==False">
                    <input type="checkbox" id="renonce_request_box" name="renonce"
                           t-att-checked="user_id.partner_id.renounce_request"
                           style="white-space: nowrap;width:20px;height:14px;"
                           class="text-xl-left border-0">
                        <label for="renonce" style="display:inline;color:#202647;font-weight:bold;">
                            Je souhaite accéder à la formation dès maintenant sans attendre 14 jours. Je reconnais que
                            DIGIMOOV procédera à l'exécution immédiate de ma formation en ligne et à ce titre, je
                            renonce expressément à exercer mon droit de rétractation conformément aux dispositions de
                            l'article L.221-28 1° du code de la consommation.
                        </label>
                    </input>
                </div>
            </div>
        </xpath>
    </template>
    <template id="portal_my_documents" name="Mes Documents">
        <t t-call="portal.portal_layout">
            <t t-set="breadcrumbs_searchbar" t-value="True"/>
            <form method="POST" t-attf-action="/new_documents" t-if="website.id==1">
                <h3>Documents
                    <t t-call="portal.portal_searchbar"/>
                    <button name="create_documents" type="action" class="btn btn-primary" groups="base.group_portal"
                            style="float: right; margin-right: 5px;">Charger mes documents
                    </button>
                </h3>
                <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
            </form>
            <form method="POST" t-attf-action="/charger_mes_documents" t-if="website.id==2">
                <h3>Documents
                    <t t-call="portal.portal_searchbar"/>
                    <button name="create_documents" type="action" class="btn btn-primary" groups="base.group_portal"
                            style="float: right; margin-right: 5px;">Charger mes documents
                    </button>
                </h3>
                <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
            </form>
            <t t-if="not documents">
                <p>Il n'y a pas de documents dans votre compte.</p>
            </t>
            <div t-if="documents" class="panel panel-default">
                <div class="table-responsive">
                    <table class="table table-hover o_portal_my_doc_table">
                        <thead>
                            <tr class="active">
                                <th>Nom</th>
                                <th>État</th>
                            </tr>
                        </thead>
                        <t t-foreach="documents" t-as="document">
                            <tr>
                                <td>
                                    <a t-attf-href="/my/documents">
                                        <t t-esc="document.name"/>
                                    </a>
                                </td>
                                <td>
                                    <a t-attf-href="/my/documents">
                                        <t t-if="document.state=='refused'">

                                            <span class="badge-danger">
                                                Refuser
                                            </span>
                                        </t>
                                        <t t-if="document.state=='waiting'">

                                            <span class="badge-warning">
                                                Vérification en cours
                                            </span>
                                        </t>
                                        <t t-if="document.state=='validated'">
                                            <span class="badge-success">
                                                Valider
                                            </span>
                                        </t>
                                    </a>
                                </td>
                                <td>
                                    <a t-attf-href="/my/document/#{document.id}" t-if="document.state=='refused'"
                                       class="btn btn-primary">
                                        Télécharger à nouveau mon document
                                    </a>
                                </td>
                            </tr>
                        </t>
                    </table>
                </div>
                <div t-if="pager" class="o_portal_pager text-center">
                    <t t-call="portal.pager"/>
                </div>
            </div>
        </t>
    </template>
</odoo>